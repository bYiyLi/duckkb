# DuckKB MCP 工具测试计划

## 测试目标

对 DuckKB 知识库 MCP 工具进行全面功能测试，发现潜在的功能问题，确保所有核心功能正常工作。

## 测试范围

### 1. 数据导入功能测试

#### 1.1 节点导入测试
- [ ] 测试 Character 节点创建（upsert）
- [ ] 测试 Document 节点创建（upsert）
- [ ] 测试 Product 节点创建（upsert）
- [ ] 测试节点更新（相同主键再次导入）
- [ ] 测试节点删除（delete 操作）
- [ ] 测试必填字段缺失时的错误处理
- [ ] 测试字段类型不匹配时的错误处理

#### 1.2 边导入测试
- [ ] 测试 knows 边创建（Character → Character）
- [ ] 测试 authored 边创建（Character → Document）
- [ ] 测试 mentions 边创建（Document → Product）
- [ ] 测试边更新（相同 source/target 再次导入）
- [ ] 测试边删除（delete 操作）
- [ ] 测试引用不存在的节点时的错误处理

### 2. 搜索功能测试

#### 2.1 混合搜索测试
- [ ] 测试基本混合搜索功能
- [ ] 测试 node_type 过滤功能
- [ ] 测试 limit 参数
- [ ] 测试 alpha 参数（向量/全文权重）
- [ ] 测试空查询结果处理
- [ ] 测试特殊字符查询

#### 2.2 向量搜索测试
- [ ] 测试基本向量搜索功能
- [ ] 测试语义相似性搜索
- [ ] 测试 node_type 过滤功能
- [ ] 测试 limit 参数

#### 2.3 全文搜索测试
- [ ] 测试基本全文搜索功能
- [ ] 测试关键词精确匹配
- [ ] 测试 node_type 过滤功能
- [ ] 测试 limit 参数

### 3. 图遍历功能测试

#### 3.1 邻居节点查询测试
- [ ] 测试获取出边邻居（direction="out"）
- [ ] 测试获取入边邻居（direction="in"）
- [ ] 测试获取双向邻居（direction="both"）
- [ ] 测试 edge_types 过滤功能
- [ ] 测试 limit 参数
- [ ] 测试不存在的节点

#### 3.2 多跳遍历测试
- [ ] 测试基本多跳遍历功能
- [ ] 测试不同遍历深度（max_depth）
- [ ] 测试遍历方向（direction）
- [ ] 测试 edge_types 过滤
- [ ] 测试 return_paths 参数
- [ ] 测试 limit 参数

#### 3.3 子图提取测试
- [ ] 测试基本子图提取功能
- [ ] 测试不同深度（max_depth）
- [ ] 测试 edge_types 过滤
- [ ] 测试 node_limit 和 edge_limit

#### 3.4 路径查找测试
- [ ] 测试两节点间路径查找
- [ ] 测试不同 max_depth
- [ ] 测试 edge_types 过滤
- [ ] 测试 limit 参数
- [ ] 测试不存在路径的情况

### 4. 图搜索融合测试

#### 4.1 向量检索 + 图遍历融合测试
- [ ] 测试基本图搜索功能
- [ ] 测试 traverse_depth 参数
- [ ] 测试 neighbor_limit 参数
- [ ] 测试 edge_types 过滤
- [ ] 测试 direction 参数

### 5. SQL 查询功能测试

#### 5.1 只读 SQL 查询测试
- [ ] 测试基本 SELECT 查询
- [ ] 测试 WHERE 条件查询
- [ ] 测试 JOIN 查询
- [ ] 测试聚合查询
- [ ] 测试排序和分页
- [ ] 测试安全限制（禁止 INSERT/UPDATE/DELETE）
- [ ] 测试危险关键字拦截

### 6. 原始记录获取测试

#### 6.1 回捞原始记录测试
- [ ] 测试从搜索结果获取原始记录
- [ ] 测试不存在的记录处理

### 7. 边界条件与异常处理测试

#### 7.1 参数边界测试
- [ ] 测试 limit=0 的处理
- [ ] 测试 limit 为负数的处理
- [ ] 测试 max_depth=0 的处理
- [ ] 测试空字符串查询

#### 7.2 数据一致性测试
- [ ] 测试并发导入相同数据
- [ ] 测试删除节点后边的处理
- [ ] 测试索引与数据一致性

## 测试执行策略

1. **准备测试数据**：创建测试用的节点和边数据
2. **按模块执行测试**：依次测试各个功能模块
3. **记录测试结果**：详细记录每个测试用例的结果
4. **问题分类**：将发现的问题按严重程度分类
   - 🔴 严重：功能完全不可用
   - 🟠 中等：功能部分可用或有明显缺陷
   - 🟡 轻微：小问题或改进建议

## 预期输出

测试完成后将生成：
1. 测试执行报告（包含每个测试用例的结果）
2. 发现的问题清单（按严重程度分类）
3. 改进建议
